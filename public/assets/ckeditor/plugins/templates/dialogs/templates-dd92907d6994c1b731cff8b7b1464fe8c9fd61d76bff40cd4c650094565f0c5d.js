!function(){CKEDITOR.dialog.add("templates",function(e){function t(e,t){var a=CKEDITOR.dom.element.createFromHtml('<a href="javascript:void(0)" tabIndex="-1" role="option" ><div class="cke_tpl_item"></div></a>'),i='<table style="width:350px;" class="cke_tpl_preview" role="presentation"><tr>';return e.image&&t&&(i+='<td class="cke_tpl_preview_img"><img src="'+CKEDITOR.getUrl(t+e.image)+'"'+(CKEDITOR.env.ie6Compat?' onload="this.width=this.width"':"")+' alt="" title=""></td>'),i+='<td style="white-space:normal;"><span class="cke_tpl_title">'+e.title+"</span><br/>",e.description&&(i+="<span>"+e.description+"</span>"),i+="</td></tr></table>",a.getFirst().setHtml(i),a.on("click",function(){n(e.html)}),a}function n(t){var n=CKEDITOR.dialog.getCurrent();n.getValueOf("selectTpl","chkInsertOpt")?(e.fire("saveSnapshot"),e.setData(t,function(){n.hide();var t=e.createRange();t.moveToElementEditStart(e.editable()),t.select(),setTimeout(function(){e.fire("saveSnapshot")},0)})):(e.insertHtml(t),n.hide())}function a(e){var t=e.data.getTarget(),n=r.equals(t);if(n||r.contains(t)){var a,i=e.data.getKeystroke(),o=r.getElementsByTag("a");if(o){if(n)a=o.getItem(0);else switch(i){case 40:a=t.getNext();break;case 38:a=t.getPrevious();break;case 13:case 32:t.fire("click")}a&&(a.focus(),e.data.preventDefault())}}}var i=CKEDITOR.plugins.get("templates");CKEDITOR.document.appendStyleSheet(CKEDITOR.getUrl(i.path+"dialogs/templates.css"));var r,i="cke_tpl_list_label_"+CKEDITOR.tools.getNextNumber(),o=e.lang.templates,s=e.config;return{title:e.lang.templates.title,minWidth:CKEDITOR.env.ie?440:400,minHeight:340,contents:[{id:"selectTpl",label:o.title,elements:[{type:"vbox",padding:5,children:[{id:"selectTplText",type:"html",html:"<span>"+o.selectPromptMsg+"</span>"},{id:"templatesList",type:"html",focus:!0,html:'<div class="cke_tpl_list" tabIndex="-1" role="listbox" aria-labelledby="'+i+'"><div class="cke_tpl_loading"><span></span></div></div><span class="cke_voice_label" id="'+i+'">'+o.options+"</span>"},{id:"chkInsertOpt",type:"checkbox",label:o.insertOption,"default":s.templates_replaceContent}]}]}],buttons:[CKEDITOR.dialog.cancelButton],onShow:function(){var e=this.getContentElement("selectTpl","templatesList");r=e.getElement(),CKEDITOR.loadTemplates(s.templates_files,function(){var n=(s.templates||"default").split(",");if(n.length){var a=r;a.setHtml("");for(var i=0,l=n.length;i<l;i++)for(var c=CKEDITOR.getTemplates(n[i]),u=c.imagesPath,c=c.templates,d=c.length,h=0;h<d;h++){var m=t(c[h],u);m.setAttribute("aria-posinset",h+1),m.setAttribute("aria-setsize",d),a.append(m)}e.focus()}else r.setHtml('<div class="cke_tpl_empty"><span>'+o.emptyListMsg+"</span></div>")}),this._.element.on("keydown",a)},onHide:function(){this._.element.removeListener("keydown",a)}}})}();